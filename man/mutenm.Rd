% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mutenm.R
\name{mutenm}
\alias{mutenm}
\title{Mutate an Elastic Network Model}
\usage{
mutenm(
  wt,
  site_mut,
  mutation,
  mut_model = "lfenm",
  mut_dl_sigma = 0.3,
  mut_sd_min = 2,
  seed = 241956
)
}
\arguments{
\item{wt}{Wild-type protein object created by \code{\link{enm}}}

\item{site_mut}{The site to mutate (sequential index, not pdb residue number)}

\item{mutation}{An integer (required). If 0, returns \code{wt} unchanged (with warning). Used with seed to generate reproducible random perturbations.}

\item{mut_model}{A string specifying mutational model ("lfenm" or "sclfenm")}

\item{mut_dl_sigma}{The standard deviation of a normal distribution from which edge-length perturbation is picked.}

\item{mut_sd_min}{An integer, only edges with \code{sdij >= mut_sd_min} are mutated}

\item{seed}{An integer, the seed for set.seed before picking perturbations}
}
\value{
A \code{prot} object for the mutant protein.
}
\description{
Generates a single-point mutant of a protein ENM by perturbing contacts at
a specified site.
}
\details{
Mutations are simulated by perturbing the equilibrium lengths of springs
connected to the mutated site. The perturbations are drawn from a normal
distribution with mean 0 and standard deviation \code{mut_dl_sigma}.

\subsection{Mutation models}{
\itemize{
  \item \code{"lfenm"} (Linear Force ENM; Echave, 2008; Echave & Fernandez, 2010):
    Fast approximation. Calculates the new equilibrium structure using linear
    response theory, but keeps the original normal modes. Dynamics-related
    properties (Dmsfi, Dmsfn, Dg_ent) will be zero.
  \item \code{"sclfenm"} (Self-Consistent LFENM; Echave, 2012): After calculating
    the new structure, rebuilds the ENM and recalculates normal modes. Slower
    but captures changes in dynamics.
}
}

\subsection{Reproducibility}{
The random seed for perturbations is set to \code{seed + site_mut * mutation},
ensuring that each site/mutation combination produces consistent results
across runs while different mutations at the same site are independent.
}

\subsection{Sequence distance filter}{
Only contacts with sequence distance >= \code{mut_sd_min} are perturbed.
This excludes local backbone contacts (i, i+1) which are less affected by
side chain mutations.
}
}
\examples{
\dontrun{
pdb <- bio3d::read.pdb("2acy")
wt <- enm(pdb, node = "ca", model = "ming_wall", d_max = 10.5)
mut <- mutenm(wt, site_mut = 11, mutation = 1, mut_model = "lfenm", seed = 1024)
}

}
\references{
Echave J (2008). Evolutionary divergence of protein structure: The linearly forced elastic network model.
\emph{Chemical Physics Letters}, 457:413-416. \doi{10.1016/j.cplett.2008.04.042}

Echave J, Fernandez FM (2010). A perturbative view of protein structural variation.
\emph{Proteins}, 78:173-180. \doi{10.1002/prot.22553}

Echave J (2012). Why are the low-energy protein normal modes evolutionarily conserved?
\emph{Pure and Applied Chemistry}, 84:1931-1937. \doi{10.1351/PAC-CON-12-02-15}
}
\seealso{
Other core functions: 
\code{\link{enm}()},
\code{\link{mrs}()},
\code{\link{plot_mrs}()}
}
\concept{core functions}
