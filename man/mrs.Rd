% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mrs.R
\name{mrs}
\alias{mrs}
\title{Mutation Response Scanning}
\usage{
mrs(
  pdb,
  node = "ca",
  model = "anm",
  d_max = 10.5,
  mut_model = "lfenm",
  nmut = 1,
  mut_dl_sigma = 0.3,
  mut_sd_min = 2,
  seed = NULL
)
}
\arguments{
\item{pdb}{A pdb object from \code{bio3d::read.pdb()}}

\item{node}{Node representation: "ca" (C-alpha), "cb" (C-beta), or "sc" (side-chain centroid)}

\item{model}{ENM model: "anm", "ming_wall", "pfanm", "reach", "hnm", or "hnm0"}

\item{d_max}{Distance cutoff for contacts (Angstroms)}

\item{mut_model}{Mutation model: "lfenm" (fast) or "sclfenm" (recalculates ENM)}

\item{nmut}{Number of mutations to simulate per site}

\item{mut_dl_sigma}{Standard deviation for bond length perturbations}

\item{mut_sd_min}{Minimum sequence distance of contacts to perturb}

\item{seed}{Random seed for reproducibility}
}
\value{
A list with components:
  \describe{
    \item{dr2ij}{Response matrix (nsites x nsites). Element [i,j] is the mean
          squared displacement at site i due to mutation at site j.}
    \item{influence}{Vector of length nsites. Column means of dr2ij —
          the average effect of mutating each site.}
    \item{sensitivity}{Vector of length nsites. Row means of dr2ij —
          the average response of each site to mutations.}
    \item{params}{List of parameters used (for reproducibility and plotting).}
  }
}
\description{
One-stop function for mutation response analysis. Takes a PDB structure,
builds an ENM, scans all sites with mutations, and returns the response
matrix along with influence and sensitivity profiles.
}
\details{
Mutation Response Scanning (MRS) provides a complete workflow:
\enumerate{
  \item Build an Elastic Network Model from the PDB structure
  \item For each site, simulate \code{nmut} random mutations
  \item Calculate the squared displacement at every site for each mutation
  \item Average over mutations to get the response matrix
  \item Compute influence (column means) and sensitivity (row means) profiles
}

The response matrix \code{dr2ij[i,j]} represents the mean squared displacement
at site \code{i} caused by mutations at site \code{j}.

\subsection{Influence and Sensitivity}{
\itemize{
  \item \strong{Influence}: How much does mutating site j affect the whole protein?
        (column means of dr2ij)
  \item \strong{Sensitivity}: How much does site i respond to mutations anywhere?
        (row means of dr2ij)
}
}
}
\examples{
\dontrun{
pdb <- bio3d::read.pdb("2acy")
result <- mrs(pdb)
# View response matrix
image(log10(result$dr2ij))
# Plot profiles
plot(result$influence, type = "l")
}

}
\seealso{
\code{\link{enm}}, \code{\link{mutenm}}, \code{\link{plot_mrs}}

Other core functions: 
\code{\link{enm}()},
\code{\link{mutenm}()}
}
\concept{core functions}
